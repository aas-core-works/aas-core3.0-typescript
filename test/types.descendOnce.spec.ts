/**
 * Test `descendOnce*` functions.
 */

// This code has been automatically generated by:
// dev_scripts/test_codegen/generate_test_for_descend_once.py
// Do NOT edit or append.

import * as path from "path";
import * as fs from "fs";

import * as AasTypes from "../src/types";
import * as TestCommon from "./common";
import * as TestCommonJsonization from "./commonJsonization";

/**
 * Compare the trace against the golden one from the test data,
 * or re-record the trace if {@link common.RECORD_MODE}.
 *
 * @param instance - to be traced
 * @param expectedPath - path to the golden trace
 */
function compareOrRecordTrace(instance: AasTypes.Class, expectedPath: string) {
  const lines = new Array<string>();
  for (const descendant of instance.descendOnce()) {
    lines.push(TestCommon.traceMark(descendant));
  }
  // NOTE (mristin, 2022-12-09):
  // We add a new line for POSIX systems which prefer a new line
  // at the end of the file.
  lines.push("");
  const got = lines.join("\n");

  if (TestCommon.RECORD_MODE) {
    const parent = path.dirname(expectedPath);
    if (!fs.existsSync(parent)) {
      fs.mkdirSync(parent, { recursive: true });
    }
    fs.writeFileSync(expectedPath, got, "utf-8");
  } else {
    if (!fs.existsSync(expectedPath)) {
      throw new Error(
        `The file with the recorded trace does not exist: ${expectedPath}; ` +
          `you probably want to set the environment ` +
          `variable ${TestCommon.RECORD_MODE_ENVIRONMENT_VARIABLE_NAME}?`
      );
    }

    const expected = fs.readFileSync(expectedPath, "utf-8").replace(/\r\n/g, "\n");
    expect(got).toStrictEqual(expected);
  }
}

test("descendOnce of Extension", () => {
  const instance = TestCommonJsonization.loadMaximalExtension();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "Extension",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of AdministrativeInformation", () => {
  const instance = TestCommonJsonization.loadMaximalAdministrativeInformation();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "AdministrativeInformation",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Qualifier", () => {
  const instance = TestCommonJsonization.loadMaximalQualifier();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "Qualifier",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of AssetAdministrationShell", () => {
  const instance = TestCommonJsonization.loadMaximalAssetAdministrationShell();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "AssetAdministrationShell",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of AssetInformation", () => {
  const instance = TestCommonJsonization.loadMaximalAssetInformation();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "AssetInformation",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Resource", () => {
  const instance = TestCommonJsonization.loadMaximalResource();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "Resource", "maximal.json.trace")
  );
});

test("descendOnce of SpecificAssetId", () => {
  const instance = TestCommonJsonization.loadMaximalSpecificAssetId();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "SpecificAssetId",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Submodel", () => {
  const instance = TestCommonJsonization.loadMaximalSubmodel();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "Submodel", "maximal.json.trace")
  );
});

test("descendOnce of RelationshipElement", () => {
  const instance = TestCommonJsonization.loadMaximalRelationshipElement();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "RelationshipElement",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of SubmodelElementList", () => {
  const instance = TestCommonJsonization.loadMaximalSubmodelElementList();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "SubmodelElementList",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of SubmodelElementCollection", () => {
  const instance = TestCommonJsonization.loadMaximalSubmodelElementCollection();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "SubmodelElementCollection",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Property", () => {
  const instance = TestCommonJsonization.loadMaximalProperty();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "Property", "maximal.json.trace")
  );
});

test("descendOnce of MultiLanguageProperty", () => {
  const instance = TestCommonJsonization.loadMaximalMultiLanguageProperty();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "MultiLanguageProperty",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Range", () => {
  const instance = TestCommonJsonization.loadMaximalRange();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "Range", "maximal.json.trace")
  );
});

test("descendOnce of ReferenceElement", () => {
  const instance = TestCommonJsonization.loadMaximalReferenceElement();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "ReferenceElement",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Blob", () => {
  const instance = TestCommonJsonization.loadMaximalBlob();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "Blob", "maximal.json.trace")
  );
});

test("descendOnce of File", () => {
  const instance = TestCommonJsonization.loadMaximalFile();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "File", "maximal.json.trace")
  );
});

test("descendOnce of AnnotatedRelationshipElement", () => {
  const instance = TestCommonJsonization.loadMaximalAnnotatedRelationshipElement();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "AnnotatedRelationshipElement",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Entity", () => {
  const instance = TestCommonJsonization.loadMaximalEntity();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "Entity", "maximal.json.trace")
  );
});

test("descendOnce of EventPayload", () => {
  const instance = TestCommonJsonization.loadMaximalEventPayload();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "EventPayload",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of BasicEventElement", () => {
  const instance = TestCommonJsonization.loadMaximalBasicEventElement();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "BasicEventElement",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Operation", () => {
  const instance = TestCommonJsonization.loadMaximalOperation();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "Operation",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of OperationVariable", () => {
  const instance = TestCommonJsonization.loadMaximalOperationVariable();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "OperationVariable",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Capability", () => {
  const instance = TestCommonJsonization.loadMaximalCapability();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "Capability",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of ConceptDescription", () => {
  const instance = TestCommonJsonization.loadMaximalConceptDescription();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "ConceptDescription",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Reference", () => {
  const instance = TestCommonJsonization.loadMaximalReference();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "Reference",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Key", () => {
  const instance = TestCommonJsonization.loadMaximalKey();

  compareOrRecordTrace(
    instance,
    path.join(TestCommon.TEST_DATA_DIR, "descendOnce", "Key", "maximal.json.trace")
  );
});

test("descendOnce of LangStringNameType", () => {
  const instance = TestCommonJsonization.loadMaximalLangStringNameType();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "LangStringNameType",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of LangStringTextType", () => {
  const instance = TestCommonJsonization.loadMaximalLangStringTextType();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "LangStringTextType",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of Environment", () => {
  const instance = TestCommonJsonization.loadMaximalEnvironment();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "Environment",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of EmbeddedDataSpecification", () => {
  const instance = TestCommonJsonization.loadMaximalEmbeddedDataSpecification();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "EmbeddedDataSpecification",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of LevelType", () => {
  const instance = TestCommonJsonization.loadMaximalLevelType();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "LevelType",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of ValueReferencePair", () => {
  const instance = TestCommonJsonization.loadMaximalValueReferencePair();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "ValueReferencePair",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of ValueList", () => {
  const instance = TestCommonJsonization.loadMaximalValueList();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "ValueList",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of LangStringPreferredNameTypeIec61360", () => {
  const instance =
    TestCommonJsonization.loadMaximalLangStringPreferredNameTypeIec61360();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "LangStringPreferredNameTypeIec61360",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of LangStringShortNameTypeIec61360", () => {
  const instance = TestCommonJsonization.loadMaximalLangStringShortNameTypeIec61360();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "LangStringShortNameTypeIec61360",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of LangStringDefinitionTypeIec61360", () => {
  const instance = TestCommonJsonization.loadMaximalLangStringDefinitionTypeIec61360();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "LangStringDefinitionTypeIec61360",
      "maximal.json.trace"
    )
  );
});

test("descendOnce of DataSpecificationIec61360", () => {
  const instance = TestCommonJsonization.loadMaximalDataSpecificationIec61360();

  compareOrRecordTrace(
    instance,
    path.join(
      TestCommon.TEST_DATA_DIR,
      "descendOnce",
      "DataSpecificationIec61360",
      "maximal.json.trace"
    )
  );
});
